<!doctype html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> &mdash; </title>
    
    <link rel="stylesheet" href="/css/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/"/>
    <link href="http://localhost:1313/index.xml" rel="alternate" type="application/rss+xml" title="" />
    <meta name="title" content="http://localhost:1313">
    <link rel="canonical" href="http://localhost:1313">
    <meta property="og:title" content=""/>
    <meta property="og:url" content="http://localhost:1313"/>
    <meta property="og:image" content="http://localhost:1313/images/"/>   
    <meta property="og:site_name" content="">
</head>
<body>
    
<section class="site-nav">
    <header>
        <nav id="navigation">
            <a class="brand" href="/">
                <img src="/images/" alt="Inc">
            </a>
            <a href="/" class="home">Blog</a>
            
            
        </nav>
        <nav class="tagline">
            
            
        </nav>
    </header>
</section>



<article>

    <div class="container">
        <header>
            <div class="meta">
                By <address><a rel="author" href="" title="" target="_blank"></a></address> &mdash;
                <time pubdate datetime="2015-03-30" title="2015-03-30">March 30, 2015</time>
            </div>
            <h1 class="title">OpenBL in pf</h1>
            <h2 class="subtitle"></h2>
        </header>

        <section>
            <p>Das Projekt <a href="https://openbl.org">OpenBL</a>, dass ursprünglich die OpenSSH
Blacklist war, hat auf der ganzen Welt verteilte Honeypots rumstehen und
publiziert regelmäßig Blacklisten sortiert nach Zeitraum und Protokoll des
Angriffs.</p>

<p>{% img center /uploads/<sup>2015</sup>&frasl;<sub>02</sub>/assholes.jpg %}</p>

<p>Das Resultat daraus kann jeder frei benutzen und zum Beispiel in seine
Firewall einbauen. Realisiert hab ich das über einen <code>pf</code> Table.</p>

<pre><code>table &lt;blacklist&gt; persist
pass in quick from &lt;admins&gt;
block quick from &lt;blacklist&gt;
</code></pre>

<p>Die Regel ist relativ unspektakulär, abgesehen davon, dass die pass-Regel
für die Admin IPs vor der Blacklist-Block Regel matchen sollte. Nur für den
Fall dass man mal selbst auf so einer Liste landen sollte.
Ein kleines Bash Script, dass mit Cron einmal die Woche die IPs updated.</p>

<pre><code class="language-bash">#!/usr/local/bin/bash
STORE=&quot;/tmp/&quot;
RULES=&quot;base.txt.gz&quot;
TABLE=&quot;blacklist&quot;
/usr/local/bin/wget -q https://www.openbl.org/lists/$RULES -P $STORE
gunzip $STORE/$RULES
pfctl -t $TABLE -T flush
pfctl -t $TABLE -T add -f $STORE/${RULES%.*}
rm $STORE/${RULES%.*}
</code></pre>

<p>Es gibt natürlich auch 10.000 andere Listen, die sowas bewerkstelligen.
Darunter auch ganze
<a href="https://github.com/khainebot/Blocklist-Downloader/blob/master/blocklistdownloader.py">Wrapper</a>
die solche Listen parsen. War mir aber dann etwas zu hart overengineert.</p>

            

        </section>

        <footer>
            <address>
               
                <p>Written by <strong><a rel="author" href="https://twitter.com/" title="" target="_blank"></a></strong><br>
                <span class="muted"></span>
                </p>
            </address>

        </footer>

        
    </div>
</article>

<footer class="site-footer">
    <div class="container">
        <nav>
            <a href=""></a> &middot;
            <a href="/">Blog</a> &middot;
            
            
        </nav>
        
        <nav class="social">
            
            
                
            <a href="/index.xml" title="RSS Feed">
                <i class="icon icon-rss black"></i>
            </a>
        </nav>
    </div>
</footer>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>











  

</body>
</html>

